\documentclass{article}

% if you need to pass options to natbib, use, e.g.:
% \PassOptionsToPackage{numbers, compress}{natbib}
% before loading nips_2017
%
% to avoid loading the natbib package, add option nonatbib:
% \usepackage[nonatbib]{nips_2017}

%\usepackage{nips_2017}

% to compile a camera-ready version, add the [final] option, e.g.:
 \usepackage[final]{nips_2017}

%\usepackage[utf8]{inputenc} % allow utf-8 input
\usepackage[T1]{fontenc}    % use 8-bit T1 fonts
\usepackage{hyperref}       % hyperlinks
\usepackage{url}            % simple URL typesetting
\usepackage{booktabs}       % professional-quality tables
\usepackage{amsfonts}       % blackboard math symbols
\usepackage{nicefrac}       % compact symbols for 1/2, etc.
\usepackage{microtype}      % microtypography
% For citations
\usepackage{natbib}
\usepackage{amsthm}
\usepackage{makecell}
% For algorithms
%\usepackage[algcompatible]{algpseudocode}
%\usepackage{algorithm}
%\usepackage{algorithmicx}
%\usepackage[noend]{algcompatible}
\usepackage[vlined,linesnumbered,ruled]{algorithm2e}
\usepackage{bbm}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{mathtools}
\usepackage{amsopn}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{enumerate}
\usepackage{soul}
\usepackage{commath}
%%%%%%%%%%%%%%%%%% toc
\usepackage{scrwfile}
\TOCclone[\contentsname~(\appendixname)]{toc}{atoc}
\newcommand\StartAppendixEntries{}
\AfterTOCHead[toc]{%
  \renewcommand\StartAppendixEntries{\value{tocdepth}=-10000\relax}%
}
\AfterTOCHead[atoc]{%
  \edef\maintocdepth{\the\value{tocdepth}}%
  \value{tocdepth}=-10000\relax%
  \renewcommand\StartAppendixEntries{\value{tocdepth}=\maintocdepth\relax}%
}
\newcommand*\appendixwithtoc{%
  \cleardoublepage
  \appendix
  \addtocontents{toc}{\protect\StartAppendixEntries}
  \listofatoc
}
\usepackage{blindtext}
\usepackage{color}
%%%%%%%%%%%%%%%%%% toc

%%%%%%%%%%%%%%%% HEADER
\newcommand{\EG}{\textsc{Epoch-Greedy}\xspace}
\newcommand{\EPG}{\textsc{$\epsilon$-Greedy}\xspace}
\newcommand{\minimonster}{\textsc{ILOVETOCONBANDITS}\xspace}
\newcommand{\ILTCB}{\textsc{ILTCB}\xspace}
\newcommand{\AdaEG}{\textsc{Ada-Greedy}\xspace}
\newcommand{\AdaILTCB}{\textsc{Ada-ILTCB}\xspace}
\newcommand{\AdaPE}{\textsc{Ada-PE}\xspace}
\newcommand{\corral}{\textsc{Corral}\xspace}
\newcommand{\bistro}{\textsc{BISTRO+}\xspace}
\newcommand{\base}[1]{{{\cal{B}}_{#1}}}
\newcommand{\scale}{\rho}
\newcommand{\FS}{\text{FS}}

\newcommand{\calA}{{\mathcal{A}}}
\newcommand{\calX}{{\mathcal{X}}}
\newcommand{\calS}{{\mathcal{S}}}
\newcommand{\calI}{{\mathcal{I}}}
\newcommand{\calJ}{{\mathcal{J}}}
\newcommand{\calK}{{\mathcal{K}}}
\newcommand{\calD}{{\mathcal{D}}}
\newcommand{\calE}{{\mathcal{E}}}
\newcommand{\calR}{{\mathcal{R}}}
\newcommand{\calT}{{\mathcal{T}}}
\newcommand{\calH}{\mathcal{H}}
\newcommand{\avgR}{\wh{\cal{R}}}
\newcommand{\calW}{{\mathcal{W}}}
\newcommand{\ips}{\wh{r}}
\newcommand{\whpi}{\wh{\pi}}
\newcommand{\whE}{\wh{\E}}
\newcommand{\whV}{\wh{V}}
\newcommand{\Reg}{\text{\rm Reg}}
\newcommand{\whReg}{\wh{\text{\rm Reg}}}
\newcommand{\flg}{\text{\rm flag}}
\newcommand{\one}{\boldsymbol{1}}
\newcommand{\var}{\Delta}
\newcommand{\p}{\prime}
\newcommand{\nb}{\nabla}
\newcommand{\e}{\mathbf{e}}

\DeclareMathOperator*{\arginf}{arginf}
\DeclareMathOperator*{\argsup}{argsup}
\DeclareMathOperator*{\range}{range}
\DeclareMathOperator*{\mydet}{det_{+}}
%\DeclarePairedDelimiter\abs{\lvert}{\rvert}
\DeclarePairedDelimiter\bigabs{\big\lvert}{\big\rvert}
\DeclarePairedDelimiter\ceil{\lceil}{\rceil}
\DeclarePairedDelimiter\floor{\lfloor}{\rfloor}
\DeclarePairedDelimiter\bigceil{\big\lceil}{\big\rceil}
\DeclarePairedDelimiter\bigfloor{\big\lfloor}{\big\rfloor}

\newcommand{\field}[1]{\mathbb{#1}}
\newcommand{\fY}{\field{Y}}
\newcommand{\fX}{\field{X}}
\newcommand{\fH}{\field{H}}
\newcommand{\fR}{\field{R}}
\newcommand{\fN}{\field{N}}
\newcommand{\E}{\field{E}}
\newcommand{\err}{\text{err}}

\newcommand{\theset}[2]{ \left\{ {#1} \,:\, {#2} \right\} }
\newcommand{\inner}[1]{ \left\langle {#1} \right\rangle }
\newcommand{\Ind}[1]{ \field{I}_{\{{#1}\}} }
\newcommand{\eye}[1]{ \boldsymbol{I}_{#1} }
%\newcommand{\norm}[1]{\left\|{#1}\right\|}
%\newcommand{\trace}[1]{\text{tr}\left({#1}\right)}
\newcommand{\trace}[1]{\textsc{tr}({#1})}
\newcommand{\diag}[1]{\mathrm{diag}\!\left\{{#1}\right\}}

\newcommand{\defeq}{\stackrel{\rm def}{=}}
\newcommand{\sgn}{\mbox{\sc sgn}}
\newcommand{\scI}{\mathcal{I}}
\newcommand{\scO}{\mathcal{O}}
\newcommand{\scN}{\mathcal{N}}

\newcommand{\dt}{\displaystyle}
\renewcommand{\ss}{\subseteq}
\newcommand{\wh}{\widehat}
\newcommand{\wt}{\widetilde}
\newcommand{\ve}{\varepsilon}
\newcommand{\hlambda}{\wh{\lambda}}
\newcommand{\yhat}{\wh{y}}

\newcommand{\hDelta}{\wh{\Delta}}
\newcommand{\hdelta}{\wh{\delta}}
\newcommand{\spin}{\{-1,+1\}}
%\newcommand{\calS}{\mathcal{S}}
\newcommand{\calC}{\mathcal{C}}

\newcommand{\cz}[1]{\textcolor{blue}{Chicheng: #1}}

%%%%%%%%%%%%%%%%%%%%%%%%

\newtheorem{assumption}{Assumption}
\newtheorem{theorem}{Theorem}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{fact}[theorem]{Fact}
\DeclareMathOperator{\val}{val}
\DeclareMathOperator{\spa}{sp}
\DeclareMathOperator{\solve}{solve}
\allowdisplaybreaks

% Packages hyperref and algorithmic misbehave sometimes.  We can fix
% this with the following command.
%\newcommand{\theHalgorithm}{\arabic{algorithm}}

\usepackage{amsmath}
\DeclareMathOperator*{\argmin}{\arg\!\min}
\DeclareMathOperator*{\argmax}{\arg\!\max}

\title{Bandit Multiclass Classification}

%\author{}

\begin{document}
% \nipsfinalcopy is no longer used

\maketitle

\section{Learning intersection of halfspaces with a margin}
Suppose we are given examples $S = \cbr{(x, y)}$, where $x$ is in $\cbr{x \in \fR^d: \| x \| \leq 1}$, and $y$ is in $\cbr{-1,+1}$.
\begin{definition}
$S$ is said to be separable by an intersection of halfspaces with margin parameter $\gamma > 0$, if there exists $t$ linear classifiers $v_1, \ldots, v_t$ (all of which are in $\cbr{v \in \fR^d: \| v \| \leq 1}$),
such that for every $(x,y)$ in $S$:
\begin{enumerate}
  \item If $y = +1$, then $v_i \cdot x \geq \gamma$ holds simultaneously for all $i$ in $[t]$.
  \item If $y = -1$, then there exists an $i$ in $[t]$, $v_i \cdot x \leq -\gamma$.
\end{enumerate}
\label{def:int-margin}
\end{definition}

Given a set $S$ separable by an intersection of halfspaces with a margin $\gamma$, our goal is to find a feature map $\phi: \fR^d \to \fR^{d'}$, such that the dataset $S' = \cbr{(\phi(x), y): (x,y) \in S}$ is linearly separable by a margin $\gamma' > 0$. That is, for every $(\phi(x), y)$ in $S'$, and
there exists a vector $u$ in $\fR^{d'}$, such that for every $(\phi(x), y)$ in $S'$, $\frac{y u \cdot \phi(x)}{\|u\|\| \phi(x)\|} \geq \gamma'$.
In addition, we would like our feature map $\phi$ to correspond to a kernel function $k(x,x') = \inner{\phi(x), \phi(x')}$ that can be efficiently evaluated.

\section{Construction of polynomials}
Our $\phi$'s in considerations are as follows: TODO: fix the constant in phi so that it has norm at most 1.
\begin{enumerate}
\item $\phi_1(x) = (x_1^{i_1} \ldots x_d^{i_d})_{i_1 + \ldots + i_d \leq \deg, i_1, \ldots, i_d \geq 0} = (x_S)_{S \in N^d, \|S\|_1 \leq \deg}$. This corresponds to the complete symmetric kernel $K_{\deg}$.
\item $\phi_2(x) = ( \sqrt{ {\deg \choose i_1+\ldots+i_d} {i_1+\ldots+i_d \choose i_1 \ldots i_d}}  x_1^{i_1} \ldots x_d^{i_d})_{i_1 + \ldots + i_d \leq \deg, i_1, \ldots, i_d \geq 0}$. This corresponds to the polynomial kernel
$K_{\deg}'(x,x') = (1 + \inner{x, x'})^{\deg}$.
\item $\phi_3(x) = ( \sqrt{ (\frac 1 2)^{i_1+\ldots+i_d} {i_1+\ldots+i_d \choose i_1 \ldots i_d}}  x_1^{i_1} \ldots x_d^{i_d})_{i_1 + \ldots + i_d \leq \deg, i_1, \ldots, i_d \geq 0}$. This corresponds to the kernel $K(x,x') = \frac{1}{1 - \frac 1 2 \inner{x,x'}}$.
\end{enumerate}

For a polynomial $p = \sum_{S \in \fN^d} c_S x_S$, define $\|p\|$, the norm of $p$, as the $\ell_2$ norm of the vector that contains its coefficients on every monomial, that is $\|p\| = \| (c_S)_{S \in \fN^d} \| = \sqrt{\sum_{S \in \fN^d} c_S^2}$. This is also the RKHS norm of $p$ wrt the complete symmetric kernel $K_{\deg}$, for $\deg \geq \deg(p)$.



\subsection{Construction using rational functions}
\paragraph{The construction.} Define rational function
\[
  Q(x) = \sum_{i=1}^t S_{\ceil{\log \frac 1 \gamma}}^{2t}(\frac{v_i \cdot x}{\gamma}) - (t - \frac 1 2).
\]
where function
\[
S_n^k(x) = \frac{P_n(-x)^{h(k)} - P_n(x)^{h(k)}}{P_n(-x)^{h(k)} + P_n(x)^{h(k)}},
\]
$h(k)$ is the smallest odd integer greater than $\log(2k+1)$, and $P_n(x) = (x - 1) \cdot \prod_{i=1}^n (x - 2^i)^2$.

Now denote by $A_n^k(x) = P_n(x)^{h(k)} - P_n(-x)^{h(k)}$, $B_n^k(x) = -P_n(-x)^{h(k)} - P_n(x)^{h(k)}$.
\cz{Note the difference between this line and KS04 - we multiply by $B_{\ceil{\log \frac 1 \gamma}}^{2t}(\frac{v_i \cdot x}\gamma)$ as opposed to its square. The latter would also work, but it will make the equations more cumbersome.}
Define polynomial $p$ as
\begin{eqnarray*}
  p(x) &:=& \sum_{i=1}^t A_{\ceil{\log \frac 1 \gamma}}^{2t}(\frac{v_i \cdot x}{\gamma}) \cdot \prod_{j \neq i} B_{\ceil{\log \frac 1 \gamma}}^{2t}(\frac{v_i \cdot x}{\gamma}) - (t-\frac12) \prod_{j=1}^t B_{\ceil{\log \frac 1 \gamma}}^{2t}(\frac{v_i \cdot x}{\gamma})
\end{eqnarray*}

It can be seen that
$p(x) = \prod_{i=1}^t B_{\ceil{\log \frac 1 \gamma}}^{2t}(\frac{v_i \cdot x}\gamma) \cdot Q(x)$.

\begin{lemma}[~\cite{klivans2004learning}]
For all $(x,y)$ in $S$ satisfying Definition~\ref{def:int-margin}, we have that $y Q(x) \geq \frac 1 2$.
As a consequence, $y p(x) \geq 2^{\frac{n(n-1)h(2t)t}2 - 2}$.
\end{lemma}
\begin{proof}
We consider two cases regarding the label of the example.
\begin{enumerate}
\item Suppose $y = 1$, then for all $i$ in $[t]$, $v_i \cdot x \in [\gamma, 1]$. This implies that $\frac{v_i \cdot x}{\gamma} \in [1, \frac 1 \gamma]$.
By item~\ref{item:sign-rt} of Fact~\ref{fact:newman}, we have that $D_i(x) \in [1, 1+ \frac 1 {2t}]$.
Hence, $Q(x) \geq t - (t - \frac 1 2) \geq \frac 1 2$.

\item Suppose $y = -1$. First observe that for all $i$ in $[t]$, $\frac{v_i \cdot x}{\gamma} \in [-\frac 1\gamma, \frac 1 \gamma]$. By items~\ref{item:sign-rt},
~\ref{item:sign-lt} and~\ref{item:sign-mid} of Fact~\ref{fact:newman}, we have that $S_{\ceil{\log \frac 1 \gamma}}^{2t}(\frac{v_i \cdot x}{\gamma}) \leq 1+ \frac 1 {2t}$.
In addition, by Definition~\ref{def:int-margin}, there exists an $i_0$ in $[t]$, such that $v_{i_0} \cdot x \leq -\gamma$.
By item~\ref{item:bound-out} of Fact~\ref{fact:cheb}, we have that
$D_{i_0}(x) \in [-1 - \frac 1 {2t}, -1]$.
Hence,
\[ Q(x) = D_{i_0}(x) + \sum_{i \neq i_0} D_i(x) - (t - \frac 1 2)
\leq -1 + (t-1)(1 + \frac 1 {2t}) - (t - \frac 1 2) \leq - \frac 1 2. \]
%\leq -1 + t-1 + \frac{t-1}{2t} - (t - \frac 1 2)
\end{enumerate}
To summarize, we have shown that for all $(x,y)$ in $S$, $y Q(x) \geq \frac 1 2$.
Therefore,
\[ y p(x) = y Q(x) \cdot \prod_{i=1}^t B_{\ceil{\log \frac 1 \gamma}}^{2t}(\frac{v_i \cdot x}\gamma) \geq \frac 1 2 ((1-\frac{1}{4t+1}) \cdot 2^{\frac{n(n-1)h(2t)}2})^t \geq 2^{\frac{n(n-1)h(2t)t}2 - 2}. \]
\end{proof}


\begin{fact}
$S_n^k(\cdot)$ has the following properties:
\begin{enumerate}
\item If $x$ is in $[1, 2^n]$, then $S_n^k(x)$ is in $[1, 1 + \frac 1 k]$. \label{item:sign-rt}
\item If $x$ is in $[-2^{-n}, -1]$, then $S_n^k(x)$ is in $[-1 - \frac 1 k, -1]$. \label{item:sign-lt}
\item If $x$ is in $[-1, 1]$, then $|S_n^k(x)|$ is in $[-1, 1]$. \label{item:sign-mid}
\item For all $x$ in $[-2^{-n}, 2^{-n}]$, $B_n^k(x) \geq (1-\frac{1}{2k+1}) \cdot 2^{\frac{n(n-1)h(k)}2}$. \label{item:sign-denom}
\end{enumerate}
\label{fact:newman}
\end{fact}
\begin{proof}
We prove all the items accordingly.
\begin{enumerate}
\item Observe that $S_n^k(x)$ can be written as:
\[ S_n^k(x) = \frac{1 + (-\frac{P_n(x)}{P_n(-x)})^{h(k)}}{ 1 - (-\frac{P_n(x)}{P_n(-x)})^{h(k)} }.  \]
Denote by $r = (-\frac{P_n(x)}{P_n(-x)})^{h(k)}$. By item~\ref{item:x-large} of Fact~\ref{fact:pn}, $r \in [0, \frac{1}{2k+1}]$. This implies that
$S_n^k(x) = \frac{1+r}{1-r} \in [1, 1 + \frac 1 k]$.

\item The item follows from item~\ref{item:sign-rt} and the fact that $S_n^k(\cdot)$ is an odd function.

\item Note that if $x$ is in $[0, 1]$, then by item~\ref{item:x-small} of Fact~\ref{fact:pn}, $r = (-\frac{P_n(x)}{P_n(-x)})^{h(k)} \in [-1, 0]$. This implies that $S_n^k(x) = \frac{1+r}{1-r} \in [0,1]$. As $S_n^k$ is an odd function, we also have that $S_n^k(x) \in [-1, 0]$ for all $x$ in $[-1, 0]$. This proves the item.

\item Noticing that $B_n^k(x)$ is an even function, without loss of generality, suppose $x \geq 0$.
First, note that if $x \geq 0$, then $\abs{P_n(-x)} \geq \prod_{i=1}^n 2^{2i} = 2^{n(n-1)}$.
If $x$ is in $[1,2^n]$, then $B_n^k(x) = \abs{P_n(-x)^{h(k)}} (1 - r) \geq \abs{P_n(-x)^{h(k)}} \cdot \frac{2k}{2k+1} \geq 2^{n(n-1)h(k)} \cdot \frac{2k}{2k+1}$.
If $x$ is in $[0,1]$, as both $P_n(-x)$ and $-P_n(x)$ are $\leq 0$, we have $B_n^k(x) \geq \abs{P_n(-x)^{h(k)}} \geq 2^{n(n-1)h(k)}$. Therefore, for all $x \in [0,2^n]$,
$\abs{B_n^k(x)} \geq (1-\frac{1}{2k+1}) 2^{n(n-1)h(k)$.
\end{enumerate}
\end{proof}

\paragraph{Norm bound.} We bound the norm of $p$ using the theorem below.
\begin{theorem}
$p(x)$ can be written as $\inner{c, \phi_1(x)}$ for some $c$ such that $\|c\| \leq$.
\end{theorem}
\begin{proof}
Let $n = \ceil{\log \frac 1 \gamma}$.

First, for all $i$ in $[t]$ and $l$ in $\cbr{0,1,\ldots,n}$,
\[ \| (\frac{v_i \cdot x}{\gamma} - 2^l) \|^2 \leq \frac{1}{\gamma^2} + 2^{2l} \leq 2 \cdot 2^{2n}. \]
This implies that
\[ \| P_n(\frac{v_i \cdot x}{\gamma}) \|^2 \leq ((4n+2) \cdot 2^{2n})^{2n+1}. \]
Therefore,
\[ \| P_n(\frac{v_i \cdot x}{\gamma})^{h(k)} \|^2 \leq h(k)^{(2n+1)h(k)} \cdot ((4n+2) \cdot 2^{2n})^{(2n+1)h(k)}. \]
%$A_n^k(x) = P_n(x)^{h(k)} - P_n(-x)^{h(k)}$, $B_n^k(x) = -P_n(-x)^{h(k)} - P_n(x)^{h(k)}$
By the definition of $A_n^k$ and $B_n^k$, we have
\[ \| A_n^k(\frac{v_i \cdot x}{\gamma}) \|^2,  \| B_n^k(\frac{v_i \cdot x}{\gamma}) \|^2 \leq ((8n+4) h(k) \cdot 2^{2n})^{(2n+1)h(k)}. \]

%\sum_{i=1}^t A_{\ceil{\log \frac 1 \gamma}}^{2t}(\frac{v_i \cdot x}{\gamma}) \cdot \prod_{j \neq i} B_{\ceil{\log \frac 1 \gamma}}^{2t}(\frac{v_i \cdot x}{\gamma}) - (t-\frac12) \prod_{j=1}^t B_{\ceil{\log \frac 1 \gamma}}^{2t}(\frac{v_i \cdot x}{\gamma})
Hence, for every $i$ in $[t]$,
\[
\| A_n^{2t}(\frac{v_i \cdot x}{\gamma}) \cdot \prod_{j \neq i} B_n^{2t}(\frac{v_j \cdot x}{\gamma}) \|^2
\leq
t^{(2n+1) h(k) t} \cdot ((8n+4) h(k) \cdot 2^{2n})^{(2n+1)h(k)t}.
\]
Similarly,
\[
\| \prod_{i=1}^t B_n^{2t}(\frac{v_i \cdot x}{\gamma}) \|^2 \leq t^{(2n+1) h(k) t} \cdot ((8n+4) h(k) \cdot 2^{2n})^{(2n+1)h(k)t}.
\]
Therefore,
\[
\| p(x) \|^2 \leq ((t - \frac 1 2)^2 + t) \cdot ((8n+4) h(k) t \cdot 2^{2n})^{(2n+1)h(k)t} \leq ((16n+8) h(k) t \cdot 2^{2n})^{(2n+1)h(k)t}.
\]
where the last inequality uses that $2^{(2n+1)h(k)t} \geq t^2 + \frac 1 4$.



\end{proof}


\begin{fact}
The following is true:
\begin{enumerate}
\item If $x \in [0,1]$, then $0 \leq -P_n(x) \leq -P_n(-x)$. \label{item:x-small}
\item If $x \in [1, 2^n]$, then $0 \leq 4P_n(x) \leq -P_n(-x)$. \label{item:x-large}
\end{enumerate}
\label{fact:pn}
\end{fact}
\begin{proof}
First, observe that for any $x \geq 0$, for all $i$, $(x+2^i)^2 \geq (x - 2^i)^2$ holds.

For the first item, given that $x \in [0,1]$, $-(-x-1) \geq 1-x \geq 0$. Therefore,
\[ \frac{-P_n(-x)}{-P_n(x)} = \frac{-(-x-1)}{1-x} \prod_{i =1}^n \frac{(x+2^i)^2}{(x - 2^i)^2}  \geq 1. \]

For the second item, given that $x \geq 1$, $-(-x-1) \geq x-1 \geq 0$. In addition, as $x$ is in $[1,2^n]$, there exists an $i_0 \in [n]$ such that $2^{i_0-1} \leq x \leq 2^i_0$. Therefore,
$(x+2^i)^2 \geq 4(x - 2^i)^2$. Hence,
\[ \frac{-P_n(-x)}{P_n(x)} = \frac{-(-x-1)}{ x-1} \prod_{i \neq i_0} \frac{(x+2^i)^2}{(x - 2^i)^2} \frac{(x+2^{i_0})^2}{(x - 2^{i_0})^2} \geq 4. \]

\end{proof}


\subsection{Construction using Chebyshev polynomials}
\paragraph{The construction.} Define
\[ p(x) = t + \frac 1 2 - \sum_{i=1}^t (T_{\ceil{\sqrt{\frac 2 \gamma}}}(1 - v_i \cdot x))^{\ceil{\log 2t}}, \]
where
$T_r(\cdot)$ is the $r$-th order Chebyshev polynomial. Denote by $C_i(x) = (T_{\ceil{\sqrt{\frac 2 \gamma}}}(1 - v_i \cdot x))^{\ceil{\log 2t}}$. $p$ can therefore be simplified to
\[ p(x) = t + \frac 1 2 - \sum_{i=1}^t C_i(x). \]

\begin{lemma}[~\cite{klivans2004learning}]
For all $(x,y)$ in $S$ satisfying Definition~\ref{def:int-margin}, we have that $y p(x) \geq \frac 1 2$.
\end{lemma}
\begin{proof}
We consider the two cases regarding the label of the example.
\begin{enumerate}
\item Suppose $y = 1$, then for all $i$ in $[t]$, $v_i \cdot x \geq \gamma$. This implies that for all
$i$ in $[t]$, $1 - v_i \cdot x \in [0, 1-\gamma]$. By item~\ref{item:bound-in} of Fact~\ref{fact:cheb}, we have that for all $i$, $|C_i(x)| \leq 1$.
Therefore, $p(x) \geq t + \frac 1 2 - t \geq \frac 1 2$.

\item Suppose $y = -1$. First observe that for all $i$, $T_{\ceil{\sqrt{\frac 2 \gamma}}}(1 - v_i \cdot x)) \geq -1$. This is because of items~\ref{item:bound-in} and~\ref{item:bound-out} of Fact~\ref{fact:cheb}.
This implies that $C_i(x) \geq -1$.
On the other hand, by Definition~\ref{def:int-margin}, there exists an $i_0$ in $[t]$, such that $v_{i_0} \cdot x \leq -\gamma$. By item~\ref{item:bound-out} of Fact~\ref{fact:cheb}, we have that
$C_{i_0}(x) \geq (1 + \gamma \cdot \frac 1 \gamma)^{\ceil{\log 2t}} \geq 2t$. Therefore,
\[ p(x) = t + \frac 1 2 - C_{i_0}(x) - \sum_{i \neq i_0} C_i(x) \leq t + \frac 1 2 - 2t + (t-1) \leq -\frac 1 2. \]
\end{enumerate}
\end{proof}

\begin{fact}
$T_r(\cdot)$ has the following properties:
\begin{enumerate}
  \item If $|z| \leq 1$, then $|T_r(z)| \leq 1$. \label{item:bound-in}
  \item If $z > 1$, then $T_r(z) \geq 1 + r^2 (z-1)$. \label{item:bound-out}
  \item $T_r(z)$ can be written as $\sum_{l=0}^r c_l z^l$, where coefficients $c_l$ are bounded by $2^r$ in absolute value.
\end{enumerate}
\label{fact:cheb}
\end{fact}

\paragraph{Norm bound.} We now bound $\| p \|$. First, for all $i$, as $v_i$ has norm at most 1,
\[ \| (1 - v_i \cdot x) \|^2 \leq 2. \]
Therefore, by Lemma~\ref{lem:norm-oper},
\[ \| c_l (1 - v_i \cdot x)^l \|^2 = c_l^2 \| (1 - v_i \cdot x)^l \|_2^2 \leq 2^{2r} l^l 2^l. \]
Hence,
\[ \| T_r(1 - v_i \cdot x) \|^2 = \| \sum_{l=0}^r c_l (1 - v_i \cdot x)^l \|^2 \leq (r+1) \cdot \sum_{l=0}^r 2^{2r} l^l 2^l \leq (r+1)^2 (8r)^r. \]
And by Lemma~\ref{lem:norm-oper},
\[ \| C_r(x) \|^2 \leq (\ceil{\log 2t})^{\ceil{\log 2t} r} \cdot ((r+1)^2 (8r)^r)^{\ceil{\log 2t}}. \]
Therefore,
\[ \| p(x) \|^2 \leq (t+1) \cdot ((t+\frac 1 2)^2 + t (\ceil{\log 2t})^{\ceil{\log 2t} r} \cdot ((r+1)^2 (8r)^r)^{\ceil{\log 2t}}) \leq 2 \cdot (32 r \ceil{\log 2t})^{2r \ceil{\log 2t}}  \]
where the last inequality uses the fact that $2^{2r \ceil{\log 2t}} \geq \max(2t^2, r^2)$.
\section{Auxiliary lemmas}
\begin{lemma}
   For $i=1,\ldots, \ell$ let $q^{(i)}(x)=\sum_S c^{(i)}_{S} x_S $ be a polynomial over $x_1, \ldots, x_d$. Then
   \begin{enumerate}
     \item if $q^{(1)}\ldots q^{(\ell)}$ has degree at most $\deg$, we have $\|\prod_{i=1}^{\ell} q^{(i)}\|^2 \leq \ell^{\deg} \prod_{i=1}^{\ell} \|q^{(i)}\|^2$. Specifically, for a polynomial $p$ of degree $s$, $\|p^\ell \|^2 \leq  \ell^{\ell s} (\|p\|^2)^\ell$.
     \item $\|\sum_{i=1}^{\ell} q^{(i)}\|^2 \leq \ell(\sum_{i=1}^{\ell} \|q^{(i)}\|^2)$.
   \end{enumerate}
   \label{lem:norm-oper}
\end{lemma}



\newpage
\bibliography{adaptivity}
\bibliographystyle{plain}

\end{document}
